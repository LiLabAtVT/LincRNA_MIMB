# Step 2. Find non-coding gene
This is the second step of the analysis.  From GTF files generated by RNA-seq analysis in the step one, we will use a python script to extract non-coding genes.
## Identification of non-coding genes
### Installation of required Python packages
Before running the script, two Python packages, Pandas and Biopython need to be installed. The two packages can be conveniently installed using pip or conda. Please refer to https://pip.pypa.io/en/stable/installing/ for installing or upgrading pip, and https://conda.io/docs/user-guide/install/index.html for installing conda.
To install Pandas and Biopython through pip, use the two commands below:
```shell
$ pip install pandas
$ pip install biopython
```
Alternatively, if you prefer using conda to install and manage the packages, use the two commands below:
```shell
$ conda install pandas
$ conda install -c anaconda biopython
```
All package dependencies will be automatically handled by pip or conda.
### Run python script
Download the two python scripts (myGTF.py and findNonCoding.py) from the [github repository](https://github.com/LiLabAtVT/LincRNA_MIMB) myGTF.py defines functions for parsing the GTF file. findNonCoding.py uses these functions to parse input file and find non-coding genes. findNonCoding.py requires four input files: 
1. a GTF format file containing annotations for genes of interest
2. BED format file that stores annotations for protein-coding genes
3. BED format file that stores annotations for transposable elements
4. FASTA format file for assembled chromosome sequences.

findNonCoding.py will ignore any transcript ID with the format of “ATXGXXXXX” and take other transcripts to check if they are the non-coding transcripts. The output file of findNonCoding.py is a list of identified non-coding gene IDs. Gene is considered as non-coding gene when all isoforms of that gene are non-coding transcripts. The non-coding transcripts are selected from the input GTF file using the four criteria:
1. Mature transcript length > 200 bps (including UTRs and exons, excluding introns).
2. Longest open reading frame does not encode more than 100 amino acids.
3. Transcribed regions do not overlap with any transposable elements
4. Transcribed regions are 500 bp away from any protein coding gene.
Before running the script, make sure myGTF.py and findNonCoding.py are put into the same directory, otherwise findNonCoding.py will fail to load the required functions.

`-h` / `--help` option can be used to display usage and help information for findNonCoding.py:
```shell
$ python findNonCoding.py --help
usage: ../src/findNonCoding.py [-h] -o OUTFILE GTF_file Pro_BED Transpos_BED FASTA

Identify non-coding genes

positional arguments:
  GTF_file              GTF file for transcripts of interest
  Pro_BED               BED file for protein coding genes
  Transpos_BED          BED fle for transposable elements
  FASTA                 FASTA file for chromosome sequences

optional arguments:
  -h, --help            show this help message and exit
  -o OUTFILE, --out OUTFILE
                        Output file name
```
Below is an example of running the script:
```shell
$ python findNonCoding.py -o out \
merged.Arath.gtf \ 
Araport11_protein_coding.201606.bed \
Araport11_transposable_element_gene.201606.bed \
TAIR10_Chr.all.fasta
```
`-o` \ `--out` specifies the output file name. In this example, the output gene list was saved into a file named ‘out’.
